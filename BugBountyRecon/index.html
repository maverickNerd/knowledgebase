<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Recon Process - Knowledge Base</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Recon Process";
    var mkdocs_page_input_path = "BugBountyRecon.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Knowledge Base</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../Virtual_Lab_Setup/">Setting up Kali Linux</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../nahamsec/recon_session_1/">NahamSec Recon Session 1 Notes</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../nahamsec/recon_session_2/">NahamSec Recon Session 2 Notes</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../bugbountynotes/firstlivementoring/">BugBountyNotes Mentoring Session</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../bugbountynotes/fastfoodhackingsession1/">BugBountyNotes FastFoodHacking Session 1</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../bugbountynotes/fastfoodhackingsession2/">BugBountyNotes FastFoodHacking Session 2</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../bugbountynotes/challengesession1/">BugBountyNotes Challenge Session 1</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../bugbountynotes/filterbypass/">BugBountyNotes Filter Bypass Session</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../tomnomnom/session1/">Tomnomnom Q&A Session</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../ippsec/tmux/">ippsec tmux Session</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../idor/">Stok IDOR Session</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../vim_tutorial/">Tomnomnom Vim Tutorial</a>
	    </li>
          
            <li class="toctree-l1 current">
		
    <a class="current" href="./">Recon Process</a>
    <ul class="subnav">
            
    <li class="toctree-l2"><a href="#bug-bounty-hunting-tip-1-always-read-the-source-code">Bug Bounty Hunting Tip #1- Always read the Source Code</a></li>
    

    <li class="toctree-l2"><a href="#1-sumdomain-enumeration">1. Sumdomain Enumeration</a></li>
    
        <ul>
        
            <li><a class="toctree-l3" href="#enumerate-subdomains">Enumerate Subdomains</a></li>
        
            <li><a class="toctree-l3" href="#3-port-scan">3. Port Scan</a></li>
        
            <li><a class="toctree-l3" href="#4-extracting-vhosts">4. Extracting vhosts</a></li>
        
            <li><a class="toctree-l3" href="#tools">Tools</a></li>
        
            <li><a class="toctree-l3" href="#web-security-mindmap">Web Security Mindmap</a></li>
        
            <li><a class="toctree-l3" href="#practical-recon-by-bharath-kumar">Practical Recon by Bharath Kumar</a></li>
        
            <li><a class="toctree-l3" href="#parameter-bruteforcing">Parameter Bruteforcing</a></li>
        
        </ul>
    

    <li class="toctree-l2"><a href="#commix-for-php-code-injection">Commix for php code injection</a></li>
    

    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Knowledge Base</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Recon Process</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <ul>
<li>
<p>Ideally you’re going to be wanting to choose a program that has a wide scope. You’re also going to be wanting to look for a bounty program that has a wider range of vulnerabilities within scope. </p>
</li>
<li>
<p>Mining information about the domains, email servers and social network connections.</p>
</li>
</ul>
<h2 id="bug-bounty-hunting-tip-1-always-read-the-source-code">Bug Bounty Hunting Tip #1- Always read the Source Code</h2>
<h2 id="1-sumdomain-enumeration">1. Sumdomain Enumeration</h2>
<h4 id="enumerate-subdomains">Enumerate Subdomains</h4>
<p>Web Tools:
https://pentest-tools.com/
https://virustotal.com/
https://www.shodan.io/
https://crt.sh/?q=%25taregt.com
https://dnsdumpster.com/
https://censys.io
http://dnsgoodies.com</p>
<p>Tools:</p>
<p>https://bitbucket.org/LaNMaSteR53/recon-ng
https://github.com/michenriksen/aquatone
https://github.com/aboul3la/Sublist3r
https://github.com/rbsec/dnscan
https://github.com/Cleveridge/cleveridge-subdomain-scanner</p>
<h5 id="screenshot-tools">Screenshot Tools</h5>
<ol>
<li>webscreenshot</li>
</ol>
<p>Make sure to install PhantomJS too.</p>
<p>$ git clone https://github.com/maaaaz/webscreenshot.git</p>
<ul>
<li>
<p>Once this is done, we use a tool called epg-prep (https://www.npmjs.com/package/epg-prep) to create thumbnails to do so, simply run: epg-prep uber.com
This will allow us to view the created pictures using express-photo-gallery.</p>
</li>
<li>
<p>In a final step, use the express-gallery-script from the bottom of this blogpost and save it as yourname.js. All you need to do is to change the folder name inside the script: app.use('/photos', Gallery('uber.com', options)); the folder name in this case is set uber.com but depending on which target you look at it may be different. Once you’ve done that you can simply run the script using node yourname.js. This will create a webserver listening on Port 3000 with an endpoint  called /photos. So to access this you simply type: http://yourserverip:3000/photos to get a nice overview of the subdomains you have enumerated</p>
</li>
</ul>
<p><strong>System Tools</strong>
apt update &amp;&amp; apt upgrade
curl -sL https://deb.nodesource.com/setup_6.x | sudo -E bash -
apt install -y git wget python python-pip phantomjs xvfb screen slurm gem phantomjs imagemagick graphicsmagick nodejs</p>
<p><strong>Requirements for WebScreenshot</strong></p>
<p>pip install webscreenshot
pip install selenium</p>
<p><strong>Requirements for express-photo-gallery</strong></p>
<p>sudo npm install -g npm
npm install express-photo-gallery
npm install express
npm install -g epg-prep</p>
<p><strong>Requirements for Aquatone</strong></p>
<p>git clone https://github.com/michenriksen/aquatone.git
cd aquatone/
gem install aquatone</p>
<p><strong>express-photo-gallery Script</strong></p>
<p>JavaScript
var express = require('express');
var app = express();</p>
<p>var Gallery = require('express-photo-gallery');</p>
<p>var options = {
  title: 'My Awesome Photo Gallery'
};</p>
<p>app.use('/photos', Gallery('uber.com', options));</p>
<p>app.listen(3000);</p>
<h5 id="sublist3r">Sublist3r</h5>
<p>$ git clone https://github.com/aboul3la/Sublist3r.git
$ cd Sublist3r
$ sudo pip install -r requirements.txt</p>
<p>alias sublist3r='python /path/to/Sublist3r/sublist3r.py -d '</p>
<p>alias sublist3r-one=". &lt;(cat domains | awk '{print \"sublist3r \"$1 \" -o \" $1 \".txt\"}')"</p>
<h5 id="dirsearch">dirsearch</h5>
<p>$ git clone https://github.com/maurosoria/dirsearch.git
$ cd dirsearch/db
$ wget https://gist.githubusercontent.com/EdOverflow/c4d6d8c43b315546892aa5dab67fdd6c/raw/7dc210b17d7742b46de340b824a0caa0f25cf3cc/open_redirect_wordlist.txt</p>
<p>alias dirsearch='python3 /path/to/dirsearch/dirsearch.py -u '
alias dirsearch-one=". &lt;(cat domains | awk '{print \"dirsearch \"\$1 \" -e <em>\"}')"
alias openredirect=". &lt;(cat domains | awk '{print \"dirsearch \"\$1 \" -w /path/to/dirsearch/db/open_redirect_wordlist.txt -e </em>\"}')"</p>
<h5 id="steps-to-take-when-approaching-a-target">Steps to take when approaching a target</h5>
<p><strong>1) Verify target’s scope (*.example.com)</strong></p>
<p><strong>2) Run Sublist3r on example.com and output all findings to a file called output:</strong></p>
<p>$ sublist3r example.com -o output
...
$ cat output
foo.example.com
bar.example.com</p>
<p><strong>3) Check which domains resolve</strong></p>
<p>Use httprobe
$ cat output | httprobe | tee -a domains</p>
<p><strong>4) Run webscreenshot on the domains file</strong></p>
<p>$ python webscreenshot.py -i domains output example</p>
<p><strong>5) Run dirsearch on the domains file</strong></p>
<p>$ dirsearch-one</p>
<p><strong>6) Check for open redirects using dirsearch on the domains file</strong></p>
<p>$ openredirect</p>
<h3 id="3-port-scan">3. Port Scan</h3>
<p>a) Masscan - https://github.com/robertdavidgraham/masscan
b) Aquatone - Use aquatone to scan the subdomains and then use it for scanning the ports you have options to Scan ports like common/large/huge</p>
<ul>
<li>
<p>Scan each individual IP address associated with their subdomains and having the output saved to a file</p>
</li>
<li>
<p>Look for any services running on unusual ports or any service running on default ports which could be vulnerable (FTP, SSH, etc). Look for the version info on services running in order to determine whether anything is outdated and potentially vulnerable</p>
</li>
</ul>
<h3 id="4-extracting-vhosts">4. Extracting vhosts</h3>
<p>Tools:
https://pentest-tools.com/information-gathering/find-virtual-hosts
https://github.com/jobertabma/virtual-host-discovery
Screenshot Tools :
Planing to Move faster try https://github.com/ChrisTruncer/EyeWitness 
httpscreenshot https://github.com/breenmachine/httpscreenshot/</p>
<ul>
<li>Look at the headers to see which security options are in place, for example looking for presence of X-XSS-Protection: or X-Frame-Options: deny. </li>
<li>Knowing what security measures are in place means you know your limitations.</li>
<li>
<p>Look out for WAFs, you can use WafW00f for that
https://github.com/sandrogauci/wafw00f</p>
</li>
<li>
<p>Wordlists: https://github.com/danielmiessler/SecLists</p>
</li>
</ul>
<h4 id="5-directory-bruteforcing">5. Directory Bruteforcing</h4>
<p>a) Dirbuster
b) gobuster
3) Burp Intruder
4) Burp Scanner</p>
<ul>
<li>Use robots.txt to determine the directories.</li>
<li>
<p>Also spider the host for API endpoints.</p>
</li>
<li>
<p>Use Wappalyzer to check CMS
or Builtwith 
or Retire.js 
or Ghostery </p>
</li>
</ul>
<h4 id="5-extracting-s3-buckets">5. Extracting s3 Buckets</h4>
<p>https://github.com/yasinS/sandcastle
https://digi.ninja/projects/bucket_finder.php</p>
<h4 id="keep-taking-notes">Keep taking notes</h4>
<p>Notes typically contains:
Whois Information
Subdomains
Dir info
S3 Buckets
social accounts
API Endpoints
emails
Vhosts
Backend IP address
Open Ports / Services running
Service version info (if applicable)
server banners
directory listings
presence security headers
WAF (+ WAF type)</p>
<ul>
<li>Dig in to website, check each request and response and analysis that, try to understand their infrastructure such as how they’re handling sessions/authentication, what type of CSRF protection they have (if any).</li>
<li>
<p>Use negative testing to through the error, this Error information is very helpful for me to finding internal paths of the website. Give time to understand the flow of the application to get a better idea of what type of vulnerabilities to look for.</p>
</li>
<li>
<p>Start to dig into using scripts for wordlist bruteforcing endpoints. This can help with finding new directories or folders that you may not have been able to find just using the website. <br />
This tends to be private admin panels, source repositories they forgot to remove such as /.git/ folders, or test/debug scripts. After that check each form of the website then try to push client side attacks. Use multiple payloads to bypass client side filters.</p>
</li>
</ul>
<h5 id="popular-google-dorks-usefinding-bug-bounty-websites">Popular Google Dorks Use(finding Bug Bounty Websites)</h5>
<p>site:.eu responsible disclosure
inurl:index.php?id=
site:.nl bug bounty
“index of” inurl:wp-content/ (Identify Wordpress Website)
inurl:”q=user/password” (for finding drupal cms )</p>
<h4 id="payloads-for-hunting">Payloads for Hunting</h4>
<p>Payloads All The Things- https://github.com/swisskyrepo/PayloadsAllTheThings/
XSS Payloads- http://www.xss-payloads.com/
XSS Payloads - https://github.com/Pgaijin66/XSS-Payloads/blob/master/payload.txt
SQL Injection Payloads - https://github.com/trietptm/SQL-Injection-Payloads
Google-Dorks Payloads - https://gist.github.com/clarketm/919457847cece7ce40323dc217623054</p>
<h4 id="approach-a-target">Approach a Target</h4>
<ul>
<li>Start early. As soon as a program is launched, start hunting immediately, if you can.</li>
<li>Once you start hunting, take a particular functionality/workflow in the application and start digging deep into it. I have stopped caring about low hanging fruits or surface bugs. There is no point focussing your efforts on those.</li>
<li>So, let’s say an application has a functionality that allows users to send emails to other users.</li>
<li>Observe this workflow/requests via a proxy tool such as Burp. Burp is pretty much the only tool I use for web app pentesting.</li>
<li>Create multiple accounts because you would want to test the emails being sent from one user to another. If you haven’t been provided multiple accounts, ask for it. Till date, I have not been refused a second account whenever I have asked for it.</li>
<li>Now, if you are slightly experienced, after a few minutes of tinkering with this workflow, you will get a feeling whether it might have something interesting going on or not. This point is difficult to explain. It will come with practice.</li>
<li>If the above is true, start fuzzing, breaking the application workflow, inserting random IDs, values, etc. wherever possible. 80% of the time, you will end up noticing weird behavior.</li>
<li>The weird behavior doesn’t necessarily mean you have found a bug that is worth reporting. It probably means you have a good chance so you should keep digging into it more.</li>
<li>There is some research that might be required as well. Let’s say you found that a particular version of an email server is being used that is outdated. Look on the internet for known vulnerabilities against it. You might encounter a known CVE with a known exploit. Try that exploit and see what happens (provided you are operating under the terms and conditions of the bug bounty).</li>
<li>There might be special tools that are required. Explore into that, if possible. Remember, Burp is a swiss army knife but you might have to use certain specific tools in certain cases. Always, be aware of that.</li>
<li>
<p>After spending a few hours on this, if you think you have exhausted all your options and are not getting anything meaningful out of it, stop and move on. Getting hung up on something is the biggest motivation killer but that doesn’t mean you are giving up. Get back to it later if something else comes up. Make a note of it.</p>
</li>
<li>
<p>Something that has worked for me is bounds checking on parameters, pick a parameter that has an obvious effect on the flow of the application.
For example, if a field takes a number (lets call it ID for lulz).
What happens if:
-you put in a minus number?
-you increment or decrement the number?
-you put in a really large number?
-you put in a string or symbol characters?
-you try traverse a directory with …/
-you put in XSS vectors?
-you put in SQLI vectors?
-you put in non-ascii characters?
-you mess with the variable type such as casting a string to an array
-you use null characters or no value</p>
</li>
</ul>
<p>I would then see if I can draw any conclusions from the outcomes of these tests,
-see if I can understand what is happening based on an error
-is anything broken or exposed
-can this action affect other things in the app.</p>
<ul>
<li>
<p>Focus on site functionality that has been redesigned or changed since a previous version of the target. Sometimes, having seen/used a bounty product before, you will notice right away any new
functionality. Other times you will read the bounty brief a few times and realize that they are giving you a map. Developers often point out the areas they think they are weak in. They/us want you to
succeed. A visual example would be new search functionality, role based access, etc. A bounty brief example would be reading a brief and noticing a lot of pointed references to the API or a particular page/function in the site.</p>
</li>
<li>
<p>If the scope allows (and you have the skillset) test the crap out of the mobile apps. While client side bugs continue to grow less severe, the API’s/web-endpoints the mobile apps talk to often touch partsof the application you wouldn’t have seen in a regular workflow. This is not to say client side bugs are not reportable, they just become low severity issues as the mobile OS’s raise the bar security-wise.</p>
</li>
<li>
<p>So after you have a thorough “feeling” for the site you need to mentally or physically keep a record of workflows in the application. You need to start asking yourself questions like these:</p>
</li>
<li>
<p>Does the page functionality display something to the users? (XSS,Content Spoofing, etc)</p>
</li>
<li>Does the page look like it might need to call on stored data?</li>
<li>(Injections of all type, Indirect object references, client side storage)</li>
<li>Does it (or can it) interact with the server file system? (Fileupload vulns, LFI, etc)</li>
<li>Is it a function worthy of securing? (CSRF, Mixed-mode)</li>
<li>
<p>Is this function a privileged one? (logic flaws, IDORs, priv escalations)
++</p>
</li>
<li>
<p>Where is input accepted and potentially displayed to the user?</p>
</li>
<li>What endpoints save data?</li>
<li>Any file upload functionality?</li>
<li>What type of authentication is used?</li>
</ul>
<h3 id="tools">Tools</h3>
<p>https://github.com/ehsahil/recon-my-way</p>
<p><strong>Read every JS</strong></p>
<p>Sometimes, Javascript files contain sensitive information including various secrets or hardcoded tokens. It’s always worth to examine JS files manually.
Find following things in Javascript.
- AWS or Other services Access keys
- AWS S3 buckets or other data storage buckets with read/write permissions.
- Open backup sql database endpoints
- Open endpoints of internal services.</p>
<p><em>JSParser</em>  - extracting links from JS file
<em>LinkFinder(https://github.com/GerbenJavado/LinkFinder)</em>    - extracting endpoints from JS files</p>
<p><em>Wordlists <br />
amass <br />
aquatone</em>       </p>
<p><strong>More subdomains:</strong></p>
<p><em>censys-enumeration</em> - https://github.com/0xbharath/censys-enumeration
<em>censys-subdomain-finder</em>
<em>shodan</em></p>
<p>Viewdns.info - Reverse whois lookup - if you know the "email id " in the registrar of a domain and you want to check what other domains are registered with the same email id you can use this site.</p>
<p>Get email address using - whois \&lt;domain.com></p>
<pre><code>$ whois domain.com
If the company is not using Domain Privacy Service,
you will find the host-masters email address then use that email to find other domains registered on same email address using Reverse Whois Lookup. Targets Registered legal name also can be used.
</code></pre>

<p><em>altdns</em> - https://github.com/infosec-au/altdns   <br />
<em>domains-from-csp</em> - https://github.com/0xbharath/domains-from-csp
<em>domain-profiler</em> - https://github.com/jpf/domain-profiler
<em>Certspotter</em> - https://certspotter.com/api/v0/certs?domain=hackerone.com
<em>Crt.sh</em> - https://crt.sh/?q=%25domain.com
<em>VHostScan</em> - https://github.com/codingo/VHostScan</p>
<p><em>dirsearch<br />
knockpy</em> - Knockpy is a python tool designed to enumerate subdomains on a target domain through a wordlist. It is designed to scan for DNS zone transfer and to try to bypass the wildcard DNS record automatically if it is enabled.
Example from @ehsahil:Why I use knockpy Initially? It provides me with a quick overlook of the subdomains with a response code.
Once, I found a subdomain takeover bug within 2 mins.
I ran knockpy on an old program’s in-scope asset with almost 150 bugs resolved on HackerOne. Quickly saw 404 page pointed to AWS S3 bucket and bucket were available to create. Hence, with no delay, I created the new AWS S3 bucket and uploaded a text file with the encoded filename and reported the bug.</p>
<p><em>lazys3(https://github.com/nahamsec/lazys3)</em> -  LazyS3 is an another tool which I use almost frequently to find the staging, sandboxed, dev and production buckets.   <br />
<em>lazyshot <br />
masscan init  <br />
s3-buckets-finder - https://digi.ninja/projects/bucket_finder.php
subfinder <br />
subresolve</em> </p>
<p><em>AWS-CLI</em> - AWS CLI is useful for verifying or testing the permissions of the AWS S3 buckets, Creating Buckets and Read other buckets data. AWS Account needed to use CLI</p>
<p><strong>Github For Recon</strong>
Github is extremely helpful in finding Sensitive information regarding the targets. Access-keys, password, open endings, s3 buckets, backup files, etc. can be found on public GitHub repositories.</p>
<p><em>subdomain.rb</em> - Subdomains By Subfinder, Subdomains By Amass, Subdomains BY Censys, Subdomains by Knockpy, Subdomains By Aquatone-discover, Subdomains By Aquatone-takeover
First find sumdoomains, sort it and pass the unique sorted domain file to recon.rb</p>
<p><em>recon.rb</em> - host, nmap, aws, dirsearch, gobuster
* waybackurl.py* - 
Searching for the targets webpages in waybackmachine, the following things can be found.
Old and abandoned JS files.
Old API endpoints.
Abandoned CDN’s Endpoints.
Abandoned Subdomains.
Dev &amp; staging endpoint with juicy info in source code comments.
If you are getting 403 on a page, you can also search that 403 pages of targets in way back machine sometimes, you will find them open with helpful information.</p>
<ul>
<li>lazyrecon : https://github.com/nahamsec/lazyrecon</li>
</ul>
<p>Create a dated folder with recon notes</p>
<p>Grab subdomains using:</p>
<ul>
<li>Sublist3r, certspotter and cert.sh</li>
<li>Dns bruteforcing using massdns
Find any CNAME records pointing to unused cloud services like aws</li>
</ul>
<p>Probe for live hosts over ports 80/443</p>
<p>Grab a screenshots of responsive hosts</p>
<p>Scrape wayback for data:</p>
<ul>
<li>Extract javascript files</li>
<li>Build custom parameter wordlist, ready to be loaded later into Burp intruder or any other tool</li>
<li>Extract any urls with .jsp, .php or .aspx and store them for further inspection
Perform nmap on specific ports</li>
</ul>
<p>Get dns information about every subdomain</p>
<p>Perform dirsearch for all subdomains</p>
<p><em>Parameth</em>
- parameth.py -u example.com/login.php -t 30 -o output.txt
Generate a HTML report with output from the tools above</p>
<p><strong>Jason Haddix</strong> (https://twitter.com/jhaddix/status/972926512595746816?lang=en)
The lost art of LINKED target discovery w/ Burp Suite: 
1) Turn off passive scanning 
2) Set forms auto to submit 
3) Set scope to advanced control and use string of target name (not a normal FQDN) 
4) Walk+browse, then spider all hosts recursively! 
5) Profit (more targets)!</p>
<p>My Methodology:</p>
<ol>
<li>Subdomain Enumeration</li>
<li>Httprobe Subdomains to get resolved and working subdomains</li>
<li>Visuan Recon</li>
</ol>
<h3 id="web-security-mindmap">Web Security Mindmap</h3>
<p><img alt="Web Security Mindmap" src="../img/webmindmap.png" /></p>
<h4 id="recon-tree-by-nahamsec">Recon Tree by @nahamsec</h4>
<p><img alt="Recon Tree by Ben" src="../img/recon_tree.jpg" /></p>
<h3 id="practical-recon-by-bharath-kumar">Practical Recon by Bharath Kumar</h3>
<ol>
<li>Enumerating Domains</li>
</ol>
<p>a. Vertical domain correlation (all the subdomain of a domain) (maps.google.com)
b. Horizontal domain corerelation ( like google.com, google.cz, youtube.com)</p>
<ul>
<li>
<p>Google Dork to use subdomain (site: helpful for finding vertical domain, ip: helpful for horizontal domain corerelation)</p>
</li>
<li>
<p>Always make shell function to automate things like this simple script:
find-subdomain-vt()
{ curl -s https://www.virustotal.com/ui/domains/$1/subdomains\?limit\=$2 }</p>
</li>
</ul>
<p><strong>Certificate Transparency</strong></p>
<ul>
<li>
<p>you can get domain names, subdomain names</p>
</li>
<li>
<p>email address in a certificate</p>
</li>
<li>
<p>you can use these websites:
crt.sh - example %eff.com
certspotter - vertical and horizontal corelation
censys.io - It stores SSL certificates, good source of domains and email address
developers.facebook.com/tools/ct/   -- this is interesting, as FB allows you to provide the domain name and email address so if there is any new subdomain comes, you will get notification on your email.
google.com/transparencyreport/https/ct/</p>
</li>
<li>
<p>Downside of CT for recon is that there is no way to remove the certificate entry so if the subdomain doesn't even exist, certificate for that still exist.</p>
</li>
<li>
<p>Use massdns along with CT logs to identify resolvable domains or use httprobe</p>
</li>
<li>
<p>When setting up some CMSs like Wordpress, or Joomla, there is a window of time when there is no authentication</p>
</li>
<li>
<p>so , if you find subomain running HTTPS and you check the CT logs as soon as certificate is issued, this can be easily exploited.</p>
</li>
<li>
<p>All the scripts are present at - https://github.com/appsecco/the-art-of-subdomain-enumeration</p>
</li>
</ul>
<p><strong>Content Security Policy</strong></p>
<p>Content-Security-Policy header allows us to create a whitelist of sources of trusted content, and instructs the browser to only execute or render resources from those domains(sources).</p>
<p>Script : https://github.com/ehsahil/recon-my-way/blob/master/domains-from-csp/csp_parser.py</p>
<p><strong>2. DNS:</strong></p>
<ul>
<li>Using SPF record of DNS - https://github.com/0xbharath/assets-from-spf/blob/master/assets_from_spf.py  </li>
</ul>
<p>you can give --asn to give you which belongs the IP block.</p>
<p>curl -s http://ip-api.com/json/192.30.253.113 |  jq -r .as
AS36459 GitHub, Inc.</p>
<ul>
<li>The ASN numbers found can be used to find netblocks of the domain.</li>
<li>We can use advanced WHOIS queries to find all the IP ranges that belong to an ASN</li>
</ul>
<p>$ whois -h whois.radb.net  -- '-i origin AS36459' | grep -Eo "([0-9.]+){4}/[0-9]+" | uniq</p>
<p>There is an Nmap script to find IP ranges that belong to an ASN that
https://nmap.org/nsedoc/scripts/targets-asn.html</p>
<p>$ nmap --script targets-asn --script-args targets-asn.asn=17012 &gt; paypal.txt</p>
<ul>
<li>you can use dig</li>
</ul>
<p>$ dig AXFR @\&lt;nameserver> \&lt;domain_name></p>
<p><strong>3. Hunting for cloud Services</strong></p>
<p>site:s3.amazonaws.com file:pdf
site:s3.amazonaws.com password</p>
<p>or site:s3.amazonaws.com + inurl:company_name</p>
<p>tools: slurp, awsbucketdump, spacefinder</p>
<p><strong>4. Github Repos for Recon</strong></p>
<p>edoverflow technique</p>
<p>search for token,key, secret, password</p>
<p><strong><em>Nahmsec</em></strong>
1. Asset Discovery</p>
<ul>
<li>Buteforce</li>
<li>Find different environments(.dev, .corp, .stage, uat etc)</li>
<li>Brute force again
 different permutations, different environments </li>
<li>Find the pattern how company is making subdomains, and use that pattern to create more permustation like dashboard-dev or dashboard.dev</li>
</ul>
<p>Tools Used:</p>
<ul>
<li>Sublist3r</li>
<li>enumall</li>
<li>massdns</li>
<li>altdns</li>
<li>brutesubs</li>
<li>dns-parallel-prober</li>
<li>dnscan</li>
<li>knockpy</li>
<li>
<p>HostileSubButeforcer</p>
</li>
<li>
<p>Certificate Transparency</p>
</li>
</ul>
<p>This is the most important steps, because the subdomains names that you find here, you cannot find from other bruteforce tools because yourwordlist does not have pattern that are available in all the subdomains or does not have keyword like gateway or payment which are part of subdomain.</p>
<p><strong>Censys</strong></p>
<ul>
<li>Look for SSL certificate:</li>
</ul>
<p>443.https.tls.certificate.parsed.extensions.subject_alt_name.dns_names:snapchat.com</p>
<p><strong>Shodan</strong></p>
<p>Ports:8443, 8080
Title: "Dashboard[Jenkins]"
Product: Tomcat
Hostname: example.com
Org: google
ssl:Google</p>
<p><strong>Use Certspotter</strong></p>
<p><strong>Use Crt.sh</strong></p>
<ol>
<li>
<p>Acquisitions</p>
</li>
<li>
<p>Check on crunchbase which company acquired what other companies.</p>
</li>
</ol>
<p><strong>So now you get all the subdomains, but now what ???</strong></p>
<ul>
<li>
<p>Run httprobe on them to find which one are resolving.</p>
</li>
<li>
<p>Content Discovery</p>
</li>
<li>
<p>Port Scan</p>
</li>
<li>Screenshot open ports</li>
<li>Look for interesting files or directories, Check robots.txt, Bruteforce (dirbuster, gograbber, gobuster, dirsearch)</li>
</ul>
<p>example:</p>
<ul>
<li>you see an open port on 8443</li>
<li>Directory brute force</li>
<li>/admin/ return 403</li>
<li>You bruteforce for more files/direcotries on /admin/</li>
<li>and let's say /admin/users.php return 200</li>
<li>Repeat on other domain, ports, folders etc</li>
</ul>
<p><strong>Amazon S3 bucket</strong>
tools: lazys3, bucketeer</p>
<p><strong>Github Recon</strong></p>
<p>Tools:
- gitrob
- truffleHog
- git-secrets
- repo-supervisors
- git-all-secrets</p>
<ul>
<li>
<p>Do it manually</p>
</li>
<li>
<p>"company.com" "dev"</p>
</li>
<li>"dev.company.com"</li>
<li>"company.com" API_key</li>
<li>"company.com" password</li>
<li>"api.company.com" authorization</li>
<li>
<p>others</p>
</li>
<li>
<p>Wayback Machine</p>
</li>
</ul>
<hr />
<p><strong>Bug Bounty Methodology</strong></p>
<ol>
<li>Discovery:</li>
</ol>
<p>Note: If you bruteforce directory, and get 401 status code(unauthorized), then keep bruteforcing inside that direcotory.</p>
<ul>
<li>
<p>Things to check:</p>
</li>
<li>
<p>Visit the search, registration, contact, password reset, and comment
forms and hit them with your polyglot strings</p>
</li>
<li>Scan those specific functions with Burp’s built-in scanner</li>
<li>Check your cookie, log out, check cookie, log in, check cookie. Submit old
cookie, see if access.</li>
<li>Perform user enumeration checks on login, registration, and password
reset.</li>
<li>Do a reset and see if; the password comes plaintext, uses a URL based
token, is predictable, can be used multiple times, or logs you in
automatically</li>
<li>Find numeric account identifiers anywhere in URLs and rotate them for
context change</li>
<li>Find the security-sensitive function(s) or files and see if vulnerable to
non-auth browsing (idors), lower-auth browsing, CSRF, CSRF protection
bypass, and see if they can be done over HTTP.</li>
<li>Directory brute for top short list on SecLists</li>
<li>Check upload functions for alternate file types that can execute code (xss
or php/etc/etc)</li>
</ul>
<h3 id="parameter-bruteforcing">Parameter Bruteforcing</h3>
<p><strong>Parameth</strong></p>
<ul>
<li>
<p>Use Parameth with portswiggerbackslash powered scanner</p>
</li>
<li>
<p>Identify IPs and main TLDs from Bug Bounty Scope (ASNs, Reverse whois)</p>
</li>
<li>Subdomain Enumeration</li>
<li>Domain bruteforcing, httprobe, massdns</li>
<li>Port Scan using masscan</li>
<li>Screenshot</li>
<li>Platform Identification(Wappalyzerm builtwith)</li>
<li>Content Discovery(Gobuster, dirbuster)</li>
<li>Parameter discovery(Parameth, Arjun)</li>
</ul>
<p><strong>Blind XSS</strong>  -&gt; XSSHunter</p>
<h2 id="commix-for-php-code-injection">Commix for php code injection</h2>
<p><strong>Bug Hunter's Methodology V3</strong></p>
<ol>
<li>
<p>Discovering IP Space:</p>
</li>
<li>
<p>Autonomous System Number (ASN) -&gt; http://bgp.he.net -&gt; check for example tesla.com and checkin Prefixes V4 to get the IP range</p>
</li>
</ol>
<p><strong>Reverse whois</strong></p>
<p>http://reverse.report</p>
<p><strong>Shodan</strong></p>
<p>org:"Tesla Motors"</p>
<ol>
<li>Discovery New Targets</li>
</ol>
<p><strong>Linked Discovery</strong></p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="../vim_tutorial/" class="btn btn-neutral" title="Tomnomnom Vim Tutorial"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../vim_tutorial/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>

</body>
</html>
