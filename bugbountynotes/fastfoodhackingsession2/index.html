<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>BugBountyNotes FastFoodHacking Session 2 - Knowledge Base</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "BugBountyNotes FastFoodHacking Session 2";
    var mkdocs_page_input_path = "bugbountynotes/fastfoodhackingsession2.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Knowledge Base</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../Virtual_Lab_Setup/">Setting up Kali Linux</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../nahamsec/recon_session_1/">NahamSec Recon Session 1 Notes</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../nahamsec/recon_session_2/">NahamSec Recon Session 2 Notes</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../firstlivementoring/">BugBountyNotes Mentoring Session</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../fastfoodhackingsession1/">BugBountyNotes FastFoodHacking Session 1</a>
	    </li>
          
            <li class="toctree-l1 current">
		
    <a class="current" href="./">BugBountyNotes FastFoodHacking Session 2</a>
    <ul class="subnav">
            
    <li class="toctree-l2"><a href="#bug-1">Bug 1</a></li>
    

    <li class="toctree-l2"><a href="#bug-2">Bug 2</a></li>
    

    <li class="toctree-l2"><a href="#bug-3">Bug 3</a></li>
    

    <li class="toctree-l2"><a href="#bug-4">Bug 4</a></li>
    

    <li class="toctree-l2"><a href="#bug-5">Bug 5</a></li>
    

    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../challengesession1/">BugBountyNotes Challenge Session 1</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../filterbypass/">BugBountyNotes Filter Bypass Session</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../tomnomnom/session1/">Tomnomnom Q&A Session</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../ippsec/tmux/">ippsec tmux Session</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../idor/">Stok IDOR Session</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../vim_tutorial/">Tomnomnom Vim Tutorial</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../BugBountyRecon/">Recon Process</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Knowledge Base</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
    
    <li>BugBountyNotes FastFoodHacking Session 2</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h3 id="bug-1">Bug 1</h3>
<p>Try this:
/FFH/?tid=lol&amp;cmid=lol
Above can be controlled as can be seen in page source.</p>
<p>/FFH/?tid=lol"-alert(1)-"cmid=lol'-alert(0)'</p>
<p>cmid worked since devloper was using only htmlentities.
So if you have used \&lt;h2>xss it would not have worked since php htmlentities html encode the h2 tag.</p>
<p>At tid, \&lt;script> is filtered, \&lt;\script> is filtered, ' or " everything is filterd.</p>
<p>Try \&lt;h2>xss in tid</p>
<p>/FFH/?tid=lol\&lt;h2>xss&amp;cmid=lol</p>
<p>It worked so payload shoudl be at tid as :</p>
<p>/FFH/?tid=\&lt;/script/x>\&lt;svg/onload="alert(1)"></p>
<h3 id="bug-2">Bug 2</h3>
<p>Log in and go to settings page.</p>
<p>On the www.bugbountytraining.com/FFH/settings.php page:</p>
<p>Send the name as xxx"&gt;\&lt;h2>hi</p>
<p>It gave invalid referrer error:</p>
<p>Remove the referer and try the request again.</p>
<p>Change the request method to GET</p>
<ul>
<li>Developer was simply checking for referer header.</li>
</ul>
<h3 id="bug-3">Bug 3</h3>
<p>On the login form, you can see the page source, there is a Javascript that says if r_url=1 it will take url and put it in redirectURL param.</p>
<p>/login.php?act-login&amp;token=yes&amp;url=http://google.com&amp;r_url=1</p>
<p>Below might bypass this filter as the devloper might be simply checking if url param is a url or not, if it is a url, block it.<br />
Developer use FILTER_VALIDATE_URL to check if its url or not.</p>
<p>/login.php?act-login&amp;token=yes&amp;url=//google.com&amp;r_url=1</p>
<p>you can also double encode https://google.com to bypass the above filter.</p>
<h3 id="bug-4">Bug 4</h3>
<p>From robot.txt page, there is /book.php and /order.php pages available.</p>
<p>Book something with test, test</p>
<p>and capture the request, as you can see there is no CSRF protection token in this.</p>
<p>We can generate the CSRF html payload and send the request using jsfiddle</p>
<p>When we send the request from jsfiddle, we get error, check on burp what happened.</p>
<p>As we can see the request, there is extra = coming in POST request, which is not valid JSON request.</p>
<p>So we change our CSRF payload.</p>
<p>= is coming because it is expcting value as we have put all payload in input name tag, we can put some stuff from the end of payload to value tag of payload.</p>
<p>Developer is messed up here because they didn't validate Content-Type: which is text/plan in this case.</p>
<p>They just checked the payload and they found it JSON so they passed it.</p>
<h3 id="bug-5">Bug 5</h3>
<p>Check the page source of book.php</p>
<p>you cna see that there is a cancel button and there is href associated with it.</p>
<p>/book.php?cancelUrl=javascript:alert(0)</p>
<p>and we are able to change href using this and alert box open.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../challengesession1/" class="btn btn-neutral float-right" title="BugBountyNotes Challenge Session 1">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../fastfoodhackingsession1/" class="btn btn-neutral" title="BugBountyNotes FastFoodHacking Session 1"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../fastfoodhackingsession1/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../challengesession1/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>

</body>
</html>
